# 하우키키 
<br>

# Team-Info
| (1) 과제명 | 고객의 상황을 반영한 응대와 주문 결제 자동화를 제공하는 휴먼터치 AI 챗오더
|:---  |---  |
| (2) 팀 번호 / 팀 이름 | 23-클로버 |
| (3) 팀 구성원 | 이여진 (2176272): 리더, 백엔드 <br> 연가은 (2171028): 팀원, AI <br> 이주연 (2171037) : 팀원, 프론트엔드		 |
| (4) 팀 지도교수 | 윤명국 교수님 |
| (5) 과제 분류 | 산학과제 |
| (6) 과제 키워드 | 생성형AI, 주문 및 매장 문의 처리, 휴먼터치 챗봇  |
| (7) 과제 내용 요약 | 하우키키는 고객의 상황을 반영한 응대와 주문 결제 자동화를 제공하는 휴먼터치 AI 챗오더입니다. 기존 키오스크 및 테이블 오더는 정형화된 선택형 인터페이스로 인해 고객의 다양한 요구를 반영하기 어렵고, 주문 외 문의 사항을 처리할 수 없어 사장님이 직접 응대해야 하는 부담이 있습니다. 이를 해결하기 위해 하우키키는 대화형 챗봇을 활용하여 고객과 자연스럽게 소통하고, 주문부터 결제, 요청사항 처리까지 자동화하는 기능을 제공합니다. <br>고객은 스마트폰으로 챗봇과 자유롭게 대화하며 메뉴 추천을 받고, 주문 및 결제를 진행할 수 있습니다. 이때 챗오더는 RAG 기술을 통해 매장 맞춤형 정보를 활용하여 고객의 질문에 최적화된 답변을 제공합니다. 또한 자연스러운 대화를 위해 Few-Shot-Prompting 기법을 포함한 프롬프트 엔지니어링을 적용하여, 매장에서 발생하는 다양한 대화 상황에 최적화했습니다. 챗오더를 통해 주문 및 요청이 들어오면 GPT가 Function Calling을 실행해  사장님께 전달되어 사장님은 주문과 요청 사항을 실시간으로 확인하고 관리할 수 있습니다. <br>최종적으로 하우키키는 1인 운영 음식점에서 챗오더 기반의 자동화된 주문 및 응대 시스템을 통해 사장님의 업무 부담을 줄이고, 고객의 주문 경험을 개선하는 것을 목표로 합니다. |

<br>

# Project-Summary
| 항목 | 내용 |
|:---  |---  |
| (1) 문제 정의 | **1. Target Customer** <br> 1) 1인 운영 음식점 사장님<br> - 매장을 혼자 운영하며 주문·결제·응대·조리를 모두 담당해야 하는 자영업자<br>- 기존 키오스크나 테이블 오더 시스템의 한계로 인해 고객 응대 부담을 직접 떠안아야 하는 경우가 많음<br>2) 음식점 이용 고객<br>- 매장에서 원활한 서비스와 신속한 응대를 원하는 고객<br>- 기존 키오스크 및 테이블 오더 시스템 사용이 어려운 고객<br><br>**2. 해결해야 할 문제점 (Pain Points)**<br>1) 1인 음식점 사장님의 Pain Points<br>- 업무 과부하: 주문, 결제, 응대, 조리를 혼자 처리해야 하므로 피로도가 높음<br>- 자동화 시스템의 한계: 기존 키오스크와 POS 시스템이 분리되어 있어 추가 연동 작업이 필요함<br>- 고객 응대 한계: 기존 키오스크와 테이블 오더 시스템은 고객 문의를 처리할 수 없어, 사장님이 직접 대응해야 하는 부담이 있음<br>2) 고객의 Pain Points<br>- 서비스 부족: 바쁜 매장에서 충분한 설명과 응대를 받기 어려움<br>- 불편한 주문 과정: 매장마다 다른 UI와 복잡한 주문 단계로 인해 학습 부담이 큼<br>- 대기 시간 증가: 직원이 부족한 상황에서 요청사항을 전달하거나 해결받는 데 시간이 오래 걸림  |
| (2) 기존연구와의 비교 | 기존의 유사 서비스로는 테이블 오더, 키오스크, 야구앤오더가 있습니다. <br><br>1. **테이블 오더:** 테이블에 있는 기계로 고객이 직접 주문하는 방식<br>- 장점: 앉은 자리에서 주문부터 결제까지 가능하고, 물, 반찬 등의 간단한 요구는 처리 가능합니다. <br>- 단점: 지정된 문의만 가능하여, 원하는 문의가 없을 때는 직원 호출이 필수적입니다. 테이블에 기기가 고정되어 있어 공간을 차지하고, 테이블 배치를 변경하거나 옮길 때 불편함을 초래합니다.<br><br>2. **키오스크:** 매장 내 설치된 터치스크린 기기를 통해 고객이 직접 주문하는 방식<br>- 장점: 주문 및 결제에 특화되어 있습니다. 큰 화면을 활용하여 메뉴 탐색이 용이합니다. <br>- 단점: 키오스크 사용에 익숙하지 않은 고객(노년층 등)은 어려움을 겪을 수 있습니다. 문의는 직원을 호출해야 처리 가능합니다. <br><br>3. **야구앤오더**: 야구 경기장에서 QR코드를 스캔하여 고객이 자리에서 주문할 수 있는 웹서비스<br>- 장점: 앉은 자리에서 바로 주문과 결제가 가능합니다. 처음에는 선택형 대화 인퍼테이스 제공하며, 주문 내역을 카톡으로 확인할 수 있습니다.<br>- 단점: 가게로 직접 문의는 불가능하며, 고객센터를 통해 문의를 해야 하는 번거로움이 있습니다. <br><br>**하우키키는** 대화형 챗봇을 기반으로, 고객의 상황을 반영한 응대와 주문 결제 자동화를 제공하는 휴먼터치 AI 챗오더입니다.<br><br>기존의 서비스와 달리 **하우키키**는 다음과 같은 장점을 가지고 있습니다.<br>- 기존의 선택형 주문 형식과 달리, 완전한 대화형 인터페이스 제공하여 대화를 통해 고객의 원하는 요구(메뉴 사진, 메뉴 주문, 문의 처리 등)를 충족합니다.<br>- 일관된 인터페이스를 통해 학습 용이성을 제공합니다.<br>- AI 챗봇이 실시간으로 응대하여 주문 중 문의를 바로 해결합니다.<br>- 반복되는 문의에 대한 응답을 자동으로 생성하여, 사장님이 직접 응대할 필요가 없습니다. |
| (3) 제안 내용 | 1. 매장 고객은 본인의 기기로 챗봇과 자연스러운 대화가 가능합니다.<br>- 챗봇이 고객의 질문에 맞춤형 정보를 제공하여, 사장님의 업무 부담을 줄이고, 고객과 원활하게 소통합니다.<br>- 단순한 FAQ 응답을 넘어, 챗봇은 사용자의 의도를 분석하고 의도에 적절한 기능을 수행합니다.<br>2. 챗봇을 통해 주문 자동 생성 및 접수 후 결제까지 처리합니다.<br>3. 사장님은 실시간 주문 상황(주문 접수, 취소)과 요청 사항을 확인 가능합니다.<br>4. 사장님은 주문 상태 변경 등의 관리가 가능하며, 주문 및 요청 사항을 한 눈에 볼 수 있습니다.<br>5. 주문을 받는 키오스크의 기능과 주문 관리의 POS기능을 하나의 웹서비스로 제공합니다. |
| (4) 기대효과 및 의의 | 1. **1인 음식점 사장님의 업무 효율성 향상** <br> - 기존의 키오스크나 테이블 오더 시스템에 비해 고객 응대 기능을 강화할 수 있어, 사장님은 더 적은 인력으로 매장을 효율적으로 운영 <br> - AI 챗봇을 통한 자동화 시스템 도입으로 주문, 결제, 문의 응대가 자동화되어 사장님의 업무 부담 경감<br>2. **매장 운영의 자동화 및 비용 절감**  <br> - 주문 및 고객 응대 자동화로 인해 직원 고용이나 추가적인 인프라 비용을 절감 <br> - 하나의 웹 서비스로 기존의 키오스크와 POS 시스템을 추가 연동이 필요하지 않아 편리성을 가진다.<br>3. **고객 만족도 증대** <br> - 고객은 챗봇을 통해 직관적이고 빠른 주문 과정을 경험 <br> - 매장에 대한 문의나 요청사항을 신속하게 해결 <br> - 고객의 상황을 반영한 답변을 제공하여, 고객 맞춤형 응대가 가능합니다.<br><br>대화형 챗봇을 통해 주문, 응대, 결제까지 자동화함으로써 1인 운영 음식점의 업무 부담을 경감하고, 고객에게 더 나은 서비스 경험을 제공합니다. 이를 통해 매장 운영 효율성을 극대화하고, 비용 절감과 고객 만족도를 동시에 향상시킬 수 있습니다. |
| (5) 주요 기능 리스트 | **1. 챗봇과의 자연스러운 대화 기능**<br>1) RAG(Retrieval-Augmented Generation)를 활용한 매장 맞춤형 정보 제공<br>- 고객의 질문에 맞춰 매장 데이터를 실시간으로 검색하고, 자연스러운 답변을 생성합니다. <br>- 예시:<br>&nbsp; &nbsp; &nbsp;- “이 매장에서 가장 인기 있는 메뉴가 뭐야?”<br>&nbsp; &nbsp; &nbsp;- “이 매장에는 비건 옵션이 있어?”<br>2) 프롬프트 엔지니어링을 통한 상황 분석 및 기능 수행<br>- 고객과의 대화 내용을 분석하여 적절한 액션(요청사항 전달, 건의사항 접수, 사진 요청, 고객 상황을 반영한 추천 등)을 수행합니다.<br>- 다양한 기호와 이모티콘 사용하고 이해하기 쉬운 용어로 답변 등  어떤 상황에서도 항상 친절한 태도를 유지하도록 프롬프트를 설계합니다.<br><br>**2. 주문 자동 생성 및 결제 기능**<br>- 챗봇은 대화에서 주문 상황을 파악하여 자동으로 주문을 생성합니다.<br>- 온라인 결제 시스템을 통해 고객은 해당 주문에 대한 결제를 챗봇에서 바로 완료할 수 있습니다.<br><br>**3. 실시간 주문 및 요청 사항 확인 기능**<br>- SSE 웹 기술을 활용하여 고객에게는 주문 취소 상황을, 사장님에게는 주문 및 요청 사항 발생 상황을 실시간으로 알림을 통해 전달할 수 있습니다.<br><br>**4. 주문 상태 변경 및 매장 관리 기능**<br>- 관리자 페이지를 구축하여 매장 관리 기능을 제공합니다.<br>- 사장님은 각 주문건의 내용을 바로 확인 가능하며, 주방 상황에 따라 주문 상태를 변경할 수 있습니다.<br>- 매장 주문과 포장 주문을 분리하여, 따로 관리할 수 있습니다.|

<br>
 
# Project-Design & Implementation
| 항목 | 내용 |
|:---  |---  |
| (1) 요구사항 정의 | *프로젝트를 완성하기 위해 필요한 요구사항을 설명하기에 가장 적합한 방법을 선택하여 기술* <br> 예) <br> - 기능별 상세 요구사항(또는 유스케이스) <br> - 설계 모델(클래스 다이어그램, 클래스 및 모듈 명세서) <br> - UI 분석/설계 모델 <br> - E-R 다이어그램/DB 설계 모델(테이블 구조) |
| (2) 전체 시스템 구성 | 본 프로젝트의 SW 전체 시스템 구조에서 주요 컴포넌트는 다음과 같이 구성됩니다.<br><br>1. **사용자 (손님, 사장님)**<br>- 손님: 매장 내 QR 코드를 스캔하여 챗봇 웹페이지에 접속하고, 매장 및 메뉴 관련 문의, 주문 및 결제, 요청 사항 전달 등의 기능을 이용할 수 있습니다.<br>- 사장님: 해당 가게의 웹사이트에 접속해 주문 내역 및 등록된 건의사항을 확인하고 주문 상태를 관리할 수 있습니다.<br>2. **웹 프론트엔드 (React + Netlify)**<br>1. 손님 및 사장님을 위한 개별 웹페이지를 제공합니다. <br>2. API 호출을 통해 챗오더 및 백엔드 서버와 통신합니다.<br>3. React 프레임워크(JavaScript)로 개발되었으며, Netlify를 통해 배포됩니다.<br>3. **챗오더 서버 (AWS EC2, Flask 기반)**<br>1. GPT 인터페이스 모듈을 통해 ChatGPT API를 호출하고, 사용자의 질문에 대한 응답을 생성합니다.<br>2. RAG (Retrieval-Augmented Generation) 기법을 활용하여 MongoDB에 저장된 매장 정보 파일(txt)을 검색 및 추출하고,  GPT 응답 생성 시 반영합니다.<br>3. 데이터 저장 및 조회가 필요한 경우 백엔드 서버 API를 호출하여 주문, 건의사항, 요청사항 등의 정보를 처리합니다.<br>4. REST API 형태로 구현되어 프론트엔드와 통신하며, 챗오더 기능을 제공합니다.<br>5. Flask 프레임워크를 기반으로 개발되었으며, AWS EC2에서 실행됩니다.<br>6. Gunicorn을 사용하여 WSGI 서버를 실행하고, Flask 애플리케이션을 여러 워커(worker) 프로세스로 처리하여 요청을 병렬 처리합니다.<br>7. Nginx를 리버스 프록시로 활용하여 외부 HTTPS 트래픽을 처리하고, Gunicorn이 실행 중인 내부 포트(8000)로 요청을 전달합니다.<br>8. CI/CD 파이프라인을 구축하여 변경사항을 자동 배포하고, 안정적인 서비스 운영을 지원합니다.<br>4. **백엔드 서버 (AWS EC2, Spring Boot 기반)**<br>1. 주요 도메인별로 메뉴, 주문, 결제, 건의사항, 알림 모듈로 구성되며, 각 모듈이 전반적인 데이터 처리 및 핵심 비즈니스 로직을 수행합니다.<br>2. 메뉴 사진을 저장하는 AWS S3, 주문·결제·건의사항 등의 데이터를 저장하는 AWS RDS (MySQL)와 연동합니다.<br>3. 각 모듈은 REST API형태로 구현되었으며, 프론트엔드와 챗오더 서버에서  API를 호출하여 요청을 처리합니다.<br>4. Spring Boot (Java) 기반으로 개발되었으며, AWS EC2에서 실행됩니다. <br>5. Nginx 웹서버를 사용하여 HTTP와 HTTPS의 요청을 내부 스프링부트 서버의 8080포트로 트래픽을 프록시 처리합니다. <br>6. CI/CD 파이프라인을 구축하여 변경사항을 EC2 서버로 자동 배포합니다.<br>5. **데이터베이스 (AWS RDS, AWS S3)**<br>- 이미지 저장 DB:  AWS S3에 이미지 버킷을 생성하고, 백엔드 서버에서 Spring Cloud AWS를 이용해 생성한 S3 버킷과 연동하여 사용합니다.<br>- 주문·결제·건의사항 등 사용자 관련 데이터 DB:  MySQL에 저장하여 관리하며 AWS RDS를 통해 클라우드 상에서 배포하여 사용합니다,<br>6. **결제 모듈 (PortOne 결제 API 연동)**<br>- 주문 시 결제를 처리하고, 결제 정보를 저장합니다.<br>- PortOne 외부 결제 API를 연동하여 결제 요청을 수행합니다. |
| (3) 주요엔진 및 기능 설계 | **1. 챗봇 서버 (GPT 인터페이스 모듈 및 Spring Boot API 호출 모듈)**<br> - GPT 인터페이스 모듈<br> - 사용자가 챗봇 페이지에서 메시지를 입력하면, GPT API를 호출하여 응답을 받아 전달합니다.<br> - 매장 문의와 주문 처리에 맞추어 설계된 프롬프트를 기반으로 챗봇이 작동하도록 합니다.<br> - 매장 정보가 필요한 질문의 경우,  RAG (Retrieval-Augmented Generation) 기법을 활용하여 미리 작성된 매장 정보 txt 파일에서 필요한 정보를 검색 후 GPT응답을 생성합니다.<br> - 사용자와의 대화 내용에서 API 호출 상황을 판단하고, 요청값을 자동 생성하여 API 호출<br> - Spring Boot API 호출 모듈<br> - 메뉴 사진 조회, 주문 생성, 주문 취소, 결제 처리, 요청사항 전달, 건의사항 등록 등의 비즈니스 로직을 처리해야하는 경우 백엔드 서버 API를 호출하여 처리합니다.<br> - 예: 주문을 생성하는 경우,  주문 생성 API의 url을 통해 post 요청을 보내 주문 데이터 생성<br> <br> **2. 백엔드 서버 (Spring Boot 기반 도메인 모듈 중 주요 기능 설명)**<br> - Menu 모듈 - 메뉴 사진 조회 API<br> - 메뉴명으로 AWS S3에 저장된 사진 URL을 조회하여 반환합니다.<br> - Order 모듈 - 주문 생성 API<br> - 요청 데이터를 바탕으로 새로운 주문을 생성하고 MySQL DB에 저장합니다.<br> - 주문이 생성되면, 알림 API를 호출하여 사장님에게 알림을 전송합니다.<br> - Pay모듈 - 결제 API (PortOne 연동)<br> - 여러 PG사 연동 API를 제공하는 PortOne 결제 시스템과 연결하여 API 호출을 통해 결제를 처리합니다.<br> - 결제 성공/실패 여부를 관리 및 결제 정보 검증을 처리하고 결제 정보를 데이터베이스에 저장합니다<br> - Suggestion 모듈 - 건의사항 저장 API<br> - 챗오더 서버에서 전송된 건의사항을 MySQL DB에 저장합니다.<br> - Notification 모듈 - 실시간 알림 (SSE: Server-Sent Events)<br> - SSE 구독 API를 사용해 HTTP Connection을 맺고, 이벤트가 발생하면 서버에서 이벤트를 푸시합니다.<br> - 주문이 생성되거나 요청 사항이 접수되면, 사장님 웹사이트에 실시간 알림을 보냅니다.<br> - 주문이 취소되었을 경우, 해당 주문을 한 손님 웹사이트에도 알림을 전송합니다.<br> <br> **3.  CI/CD 자동화 (GitHub Actions + AWS S3 + AWS CodeDeploy)**<br> 배포 과정 자동화를 위해 CI/CD 파이프라인을 구축하였으며, 프로세스는 다음과 같습니다.<br> 1. 개발자가 GitHub에 코드를 Push합니다. <br> 2. GitHub Actions가 자동으로 빌드 및 zip 파일 생성합니다.<br> 3.  AWS S3에 빌드 파일 업로드합니다.<br> 4. 해당 빌드 파일을 이용해 AWS CodeDeploy가 EC2 서버에 자동 배포합니다. |
| (4) 주요 기능의 구현 | 1. **챗봇과의 자연스러운 대화 기능**<br> 프롬프트 엔지니어링과 Rag를 사용하여, 고객이 챗봇과 자연스러운 대화를 할 수 있도록 설계하였습니다.<br>- 프롬프트 엔지니어링 : 고객의 다양한 문의에 적절하게 대응할 수 있도록, 프롬프트를 ‘주문 지원(주문 수정, 주문 출력)’, ‘정중하고 친절한 대화’, ‘요청 사항 처리’, ‘컴플레인 처리’ 등의 카테고리로 나누어 구체적으로 설계하였습니다. 이를 통해 챗봇이 상황에 맞는 응답을 생성하고, 자연스럽고 친절한 고객 응대를 제공할 수 있도록 하였습니다.<br>- Rag : 매장별 정보를 txt 파일 형태로 저장하고, 챗봇이 고객의 질문을 분석하여 적절한 정보를 찾아 제공하는 방식으로 RAG를 활용하였습니다. txt 파일에는 ‘메뉴 카테고리’, ‘메뉴 정보’, ‘메인 메뉴’, ‘고객 맞춤형 추천 메뉴(매운 음식, 여성 고객 대상, 어린이 대상 등)’, ‘이벤트 및 프로모션’ 등의 정보가 포함되어 있습니다. 이를 바탕으로 챗봇은 고객의 요구에 맞춰 적절한 답변을 생성할 수 있습니다.<br<br> 2. **Function Calling을 활용한 주문 처리**<br>GPT 모델은 기본적으로 실시간 데이터를 제공하지 않지만, Function Calling 기능을 활용하면 외부 시스템과 연동하여 추가적인 기능을 수행할 수 있습니다. 이를 주문 처리에 적용하여 보다 자연스럽고 효율적인 챗오더 시스템을 구축하였습니다. 이 시스템에서는 GPT가 사용자의 대화 흐름을 분석하고 최종 주문이 확정된 경우에만 Function Calling을 실행하여 주문을 처리합니다.<br>1. Function Calling을 활용한 주문 처리 흐름<br>1) 주문 요청 및 수정 가능<br>- 손님이 메뉴를 주문하면, GPT는 주문 내역을 분석하여 응답합니다<br>- 하지만 이 단계에서는 즉시 Function Calling을 호출하지 않고, 손님이 주문을 추가하거나 수정할 수 있도록 합니다.<br>2) 최종 주문 여부 확인 <br>- 손님이 주문을 확정하지 않은 경우, GPT는 "추가하실 메뉴가 있나요?" 등의 질문을 통해 대화를 유지합니다.<br>- 손님이 "이대로 주문할게요." 또는 "응"과 같은 확정 의사를 보이면, GPT가 최종 주문 내역을 출력합니다.<br>- 이 과정에서 프롬프트 엔지니어링을 활용하여 최종 주문을 판별하는 특정 응답 패턴을 설계하였습니다.<br>3) 최종 주문 내역 포함 후 Function Calling 실행<br> - GPT 응답에 최종 주문 내역을 포함하는 경우에만 Function Calling을 실행합니다.<br> - Function Calling이 실행되면, 백엔드 API를 호출하여 실제 주문을 생성합니다.<br>2. Function Calling 구현 방식<br> 1) Function Calling을 위해 주문을 처리하는 API를 호출하는 함수 정의합니다.<br>2) GPT에게 주문을 처리할 수 있도록 Function Calling을 등록합니다.<br> 3) 손님의 주문이 확정되었을 때만 GPT가 Function Calling을 실행하도록 설정합니다**.**<br><br>3. **실시간 주문 및 요청 사항 확인을 위한 알림 시스템**<br>실시간으로 주문 및 요청 사항을 확인할 수 있도록 SSE(Server-Sent Events) 웹 기술을 적용하였습니다. SSE는 서버에서 클라이언트로 데이터를 비동기적으로 전송할 수 있는 단방향 통신 기술로, 이를 통해 운영자와 고객 간의 실시간 알림 기능을 구현하였습니다.<br>운영자는 가게 명으로 사이트에 접속하면 미리 정해진 각 가게의 토큰을 통해 자동으로 SSE연결이 이루어지며, 고객은 챗봇을 시작하는 순간 발급받은 토큰을 통해 SSE 연결이 활성화됩니다. 서버에서는 Spring Framework의 SseEmitter API를 활용하여 클라이언트가 SSE 요청을 보내면 매핑되는 SSE 통신 객체(SseEmitter)를 생성하고, 이벤트가 발생하면 이를 클라이언트에 전송하는 방식으로 동작합니다.<br>SSE 웹 기술을 활용하여 구현된 알림 기능은 총 세 가지로, 주문 도착 알림, 요청사항 도착 알림, 주문 취소 알림이 있습니다.<br>고객이 챗봇을 통해 주문하거나 요청사항을 전달하면, 운영자 페이지에서 알림 이벤트를 감지하여 자동으로 팝업 알림이 표시되도록 구현하였습니다. 주문의 경우, 고객이 실수로 잘못 입력하는 상황을 고려하여 30초의 주문 취소 가능 시간을 설정하였으며, 이에 따라 메뉴 주문 알림 팝업은 30초 후에 운영자 페이지에 표시되고, 요청사항 알림 팝업은 즉시 표시됩니다.<br>또한, 운영자가 재료 소진, 라스트오더 종료, 기타 사유로 인해 고객의 주문을 취소해야 하는 경우, 주문 취소 즉시 고객 챗봇 화면에 취소 사유와 함께 팝업 알림이 표시되도록 구현하였습니다. |
| (5) 기타 | *기타 사항을 기술*  |

<br>
